/* ===================== Theme Variables by Season ===================== */
:root {
  --bg1: #07140a; --bg2: #021006;
  --ink: #e9ffef; --muted:#a6d7b1;
  --panel: #0b2313b3; --panel-border:#2a6e3f;
  --accent:#6df2a5; --accent2:#31c07a; --accent3:#e9ffef;
  --branch: #3bd28b; --leaf: #5cf5a2; --leaf-dim:#3eb574;
  --danger:#e45c6c;
  --ring:#6df2a533;
}

/* Season presets (toggled by body class) */
body.summer {
  --bg1:#062116; --bg2:#01150a; --panel:#0a2717b3;
  --panel-border:#2c7e56; --accent:#8ff2b6; --accent2:#34c08a;
  --branch:#45e1a0; --leaf:#7ef5c0; --leaf-dim:#49c091;
}
body.autumn {
  --bg1:#1f1305; --bg2:#0a0702; --panel:#2b190bb3;
  --panel-border:#8a5a2a; --accent:#ffcb6b; --accent2:#e98f2b;
  --branch:#ffb24a; --leaf:#ffd38a; --leaf-dim:#e09638; --ink:#fff4e3; --muted:#f1cfa4;
}
body.winter {
  --bg1:#06121c; --bg2:#030a11; --panel:#0a1c2ab3;
  --panel-border:#2e6b8a; --accent:#7bd0ff; --accent2:#4aa6e6;
  --branch:#6bc4ff; --leaf:#a6e2ff; --leaf-dim:#5aa9df; --ink:#eaf7ff; --muted:#b8d7ef;
}

/* ===================== Base Layout ===================== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font:15.5px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--ink);
  background: radial-gradient(1200px 800px at 50% -10%, var(--bg1) 0%, transparent 60%), var(--bg2);
  overflow:hidden; /* no page scrollbars */
}

canvas#bgAuras{
  position:fixed; inset:0; z-index:-2;
  filter: saturate(1.2) brightness(1.05);
}

header{text-align:center; padding:16px 8px 6px}
h1{margin:0; font-size:28px; color:var(--accent)}
h1 span{color:var(--accent2)}
.tagline{margin-top:4px; color:var(--muted); font-size:13px}

main{display:grid; grid-template-rows:auto 1fr; gap:12px; height:calc(100vh - 88px); padding:0 12px 12px}
.panel{
  background:var(--panel); border:1px solid var(--panel-border); border-radius:16px;
  box-shadow:0 12px 30px #00000035; backdrop-filter:blur(8px);
}
#controls{display:flex; gap:16px; padding:12px 14px}
#controls .left{flex:1}
#controls .right{width:430px; max-width:45%}
#controls h2{margin:0 0 8px; font-size:16px; color:var(--accent)}
.row{display:flex; gap:8px; align-items:center; margin-bottom:8px}
.row.tiny{margin-bottom:0}
.label{color:var(--muted); font-size:13px}

input,select{
  flex:1; padding:10px 12px; border-radius:12px; border:1px solid var(--panel-border);
  background:#07160e; color:var(--ink); outline:none;
}
input:focus,select:focus{box-shadow:0 0 0 3px var(--ring); border-color:var(--accent2)}

.btn{
  border:0; border-radius:12px; padding:10px 14px; font-weight:800; letter-spacing:.2px; cursor:pointer;
  color:#05140b; background:linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow:0 8px 22px #00000030;
}
.btn.ghost{background:#0c2215; color:var(--ink); border:1px solid var(--panel-border)}
.btn.danger{background:linear-gradient(90deg, var(--danger), #ba3c4c); color:#fff}

.hint{color:var(--muted); font-size:12.5px; margin:6px 0 0}

#stage{position:relative; overflow:hidden; padding:0}
#branches{position:absolute; inset:0; z-index:0}
#nodes{position:absolute; inset:0; z-index:1}

/* Nodes (DOM) */
.node{position:absolute; transform:translate(-50%,-50%); user-select:none; text-align:center}
.branch{
  width:150px; height:150px; border-radius:50%;
  background: radial-gradient(60% 60% at 40% 30%, #184e31, #0b2b18);
  border:2px solid var(--branch); color:var(--ink); font-weight:800;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 0 20px color-mix(in srgb, var(--branch) 40%, transparent) inset, 0 0 26px #00000020;
  transition:transform .2s ease, filter .2s ease, box-shadow .2s ease;
}
.branch:hover{transform:translate(-50%,-50%) scale(1.05)}
.branch.collapsed{filter:grayscale(.25) brightness(.9); opacity:.95}

.leaf{
  width:110px; height:110px; border-radius:50%;
  background: radial-gradient(60% 60% at 40% 30%, #0f3a23, #092014);
  border:2px dashed var(--leaf-dim); color:var(--muted); font-weight:700;
  display:flex; align-items:center; justify-content:center;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease, color .2s ease;
}
.leaf.complete{
  border-style:solid; border-color:var(--leaf); color:var(--ink);
  box-shadow:0 0 22px color-mix(in srgb, var(--leaf) 40%, transparent), inset 0 0 16px color-mix(in srgb, var(--leaf) 24%, transparent);
  transform:translate(-50%,-50%) scale(1.06);
}

footer{text-align:center; color:var(--muted); font-size:12.5px; padding:6px 0 10px}
