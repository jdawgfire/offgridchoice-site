/* ---------- Season variables (nature/organic) ---------- */
:root{
  --bg1:#08140b; --bg2:#041006;
  --ink:#e9ffef; --muted:#a6d7b1;
  --panel:#0c2314cc; --panel-border:#2a6e3f;
  --accent:#6df2a5; --accent2:#31c07a;
  --branch:#38c77f; --leaf:#66f0aa; --leaf-dim:#3eb574;
  --danger:#e45c6c; --ring:#6df2a533;
}
body.summer{ --bg1:#0b2015; --bg2:#07170e; --panel:#0c2a19cc; --panel-border:#2a7f58;
  --accent:#8ff2b6; --accent2:#35c18a; --branch:#46df9e; --leaf:#7ff7c1; --leaf-dim:#4cc395; }
body.autumn{ --bg1:#1a1105; --bg2:#0b0703; --panel:#2a1a0ccc; --panel-border:#8b592a;
  --accent:#ffd07a; --accent2:#e89b38; --branch:#ffb24a; --leaf:#ffd999; --leaf-dim:#e2963a; --ink:#fff5e6; --muted:#f1cfaa; }
body.winter{ --bg1:#06121c; --bg2:#030a11; --panel:#0a1c2acc; --panel-border:#2e6b8a;
  --accent:#92d9ff; --accent2:#4aa6e6; --branch:#6cc4ff; --leaf:#b8e6ff; --leaf-dim:#5aabdf; --ink:#eaf7ff; --muted:#b8d7ef; }

/* ---------- Base layout ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font:15.5px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--ink);
  background:radial-gradient(1200px 800px at 60% -10%, var(--bg1) 0%, transparent 60%), var(--bg2);
  overflow:hidden; /* fullscreen stage; no page scrollbars */
}
#bgAuras{position:fixed; inset:0; z-index:-2; filter:saturate(1.1) brightness(1.06)}

header{text-align:center; padding:14px 8px 4px}
h1{margin:0; font-size:28px; color:var(--accent)}
h1 span{color:var(--accent2)}
.tagline{margin-top:4px; color:var(--muted); font-size:13px}

main{display:grid; grid-template-rows:auto 1fr; gap:12px; height:calc(100vh - 84px); padding:0 12px 12px}
.panel{
  background:var(--panel); border:1px solid var(--panel-border); border-radius:16px;
  box-shadow:0 12px 30px #00000035; backdrop-filter:blur(8px);
}

#controls{display:flex; gap:16px; padding:12px 14px}
#controls .left{flex:1}
#controls .right{width:420px; max-width:45%}
#controls h2{margin:0 0 8px; font-size:16px; color:var(--accent)}
.row{display:flex; gap:8px; align-items:center; margin-bottom:8px}
.row.tiny{margin-bottom:0}
.label{color:var(--muted); font-size:13px}

input,select{
  flex:1; padding:10px 12px; border-radius:12px; border:1px solid var(--panel-border);
  background:#07170e; color:var(--ink); outline:none;
}
input:focus,select:focus{box-shadow:0 0 0 3px var(--ring); border-color:var(--accent2)}

.btn{
  border:0; border-radius:12px; padding:10px 14px; font-weight:800; letter-spacing:.2px; cursor:pointer;
  color:#04120a; background:linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow:0 8px 22px #00000030;
}
.btn.ghost{background:#0c2215; color:var(--ink); border:1px solid var(--panel-border)}
.btn.danger{background:linear-gradient(90deg, var(--danger), #ba3c4c); color:#fff}

.hint{color:var(--muted); font-size:12.5px; margin:6px 0 0}

/* Stage */
#stage{position:relative; overflow:hidden; padding:0}
#branches{position:absolute; inset:0; z-index:0}
#nodes{position:absolute; inset:0; z-index:1}

/* Nodes */
.node{position:absolute; transform:translate(-50%,-50%); user-select:none; text-align:center}
.branch{
  width:150px; height:150px; border-radius:50%;
  background:radial-gradient(60% 60% at 45% 30%, #174a2c, #0a2a18);
  border:2px solid var(--branch); color:var(--ink); font-weight:800;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 0 20px color-mix(in srgb, var(--branch) 40%, transparent) inset, 0 0 26px #00000020;
  transition:transform .2s ease, filter .2s ease, box-shadow .2s ease;
}
.branch:hover{transform:translate(-50%,-50%) scale(1.05)}
.branch.collapsed{filter:grayscale(.25) brightness(.9); opacity:.95}

.leaf{
  width:110px; height:110px; border-radius:50%;
  background:radial-gradient(60% 60% at 45% 30%, #0f3a23, #092014);
  border:2px dashed var(--leaf-dim); color:var(--muted); font-weight:700;
  display:flex; align-items:center; justify-content:center;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease, color .2s ease;
}
.leaf.complete{
  border-style:solid; border-color:var(--leaf); color:var(--ink);
  box-shadow:0 0 22px color-mix(in srgb, var(--leaf) 40%, transparent), inset 0 0 16px color-mix(in srgb, var(--leaf) 24%, transparent);
  transform:translate(-50%,-50%) scale(1.06);
}

/* Toggle switch (sound) */
.switch{position:relative; width:44px; height:24px; display:inline-block}
.switch input{display:none}
.switch span{position:absolute; inset:0; background:#0c2215; border:1px solid var(--panel-border); border-radius:999px}
.switch span::after{content:""; position:absolute; width:20px; height:20px; border-radius:50%; background:var(--accent); left:2px; top:2px; transition:transform .18s}
.switch input:checked + span::after{transform:translateX(20px)}
